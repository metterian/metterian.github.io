---
layout: post
title: "베이즈 정리의 두가지 맥락"
author: "metterian"
tags: 확률과 통계
---
## 베이즈 정리

> 베이즈 정리(Bayes' theorem). 어떤 사건이 서로 배반하는 원인 둘에 의해 일어난다고 할 때 실제 사건이 일어났을 때 이것이 두 원인 중 하나일 확률을 구하는 정리를 베이즈의 정리라고 한다. 공식의 형태는 다음과 같다.
>
> $$
> P(B \mid A)=\frac{P(A \mid B) P(B)}{P(A)}
> $$

<br>

## 베이즈 정리의 두 가지 맥락

### 역확률 문제

베이즈 정리는 원래 역확률(Inverse probability) 문제를 해결하기 위한 방법이였습니다. 즉, 조건부 확률 $P(B \mid A)$ 를 알고 있을때, 전제 사건의 관계가 정반대인 조건부 확률 $P(A \mid B)$ 을 구하는 방법이였습니다.

예를 들어, 병 A를 알고 있는지 판정하는 양성 판정 정확도(즉, 병A가 결린 사람이 실제로 테스트 결과 양성으로 나올 확률)가 90% 검사기가 있다고 가정해 봅시다. 이때, 어떤 사람이 이 검사기로 검사를 시행해서 양성 결과가 나왔다면, 이 사람이 90%의 확률로 병에 걸렸다고 이야기 할 수 있을까요? 그렇지 않습니다. 왜냐하면 검사가 알려주는 확률과 우리가 알고 싶은 확율은 조건부 확률의 의미에서 정반대이기 때문입니다.

- 검사의 양성판정 정확도 '90%는' 검사가 병을 가진 사람을 정확하게 포착할 확률, 즉 **병을 가지고 있다는 전제하에 검사 결과가 양성일 확률** 90%를 의미합니다.
- 하지만, 우리가 알고 싶은 것은 검**사결과가 양성이라는 전제하에 병을 앓고 있을 확률**입니다. 조건부 확률의 관점에서 보면 전제(조건)의 관심 사건의 관계가 정반대이기 때문에, 이런 식의 확률을 구해야 하는 문제를 역확률 문제라고 합니다.



|                   |      전제       |  **관심사건**   |                 수학적표현                 |
| :---------------: | :-------------: | :-------------: | :----------------------------------------: |
| **검사의 정확도** | 병을 앓고 있다  | 검사 결과: 양성 | P(검사 결과: 양성\|병을 앓고 있다) = 0.90  |
| **우리의 관심사** | 검사 결과: 양성 | 병을 앓고 있다  | P(병을 앓고 있다\|검사 결과: 양성) = ....? |

<br>

원래대로라면 검사의 정확도만을 가지고 우리의 관심사인 (양성인 사람이)병을 앓고 있을 확률을 알 수 없습니다. 하지만, 우리가 검사 대상인 질병의 유병률을 알고 있다면, 베이즈 정리를 통해 역확률을 계산 할 수 있습니다.

예를 들어, 전세계 인구중 1%의 사람들이 병 A를 앓는다고 알려져 있다고 가정 해 봅시다. 그리고 음성판정 정확도 (병 A가 걸리지 않는 사람이 실제로 테스트 결과 음성으로 나올 확률)도 양성판정 정확도와 마찬가지로 90%로 가정합시다. 그렇다면 검사 결과가 나온 사람이 실제로 A를 알고 있을 확률은 약 8.3%입니다.

$$
\begin{aligned}
P(\text { 병 } \mid \text { 양성 }) &=\frac{P(\text { 양성 } \mid \text { 병 }) P(\text { 병 })}{P(\text { 양성 })} \\
&=\frac{P(\text { 양성 } \mid \text { 병 }) P(\text { 병 })}{P(\text { 양성 } \mid \text { 병 }) P(\text { 병 })+P(\text { 양성 } \mid \text { 무병 }) P(\text { 무병 })} \\
&=\frac{0.9 \times 0.01}{0.9 \times 0.01+(1-0.9) \times 0.99} \approx 8.3 \%
\end{aligned} \\
(\text{단, } P(B)=P(B \mid A) P(A)+P\left(B \mid A^{\subset}\right) P\left(A^{\subset}\right))
$$

<br>

### 데이터를 이용한 사후 확률의 추정

이러한 베이즈 정리를 어떤 사건의 확률을 추론하는 알고리즘으로 관심을 가지는 사람들을 나이브 베이지안 알고리즘을 만든 사람들 입니다. 이 때는 어떤 사건이 일어날 확류에 대한 임의의 가정 $P(A)$에 실제로 발견된 자료나 증거 $B$를 반영해서, 자료로 미루어보아 어떤 사건이 일어날 확률 $P(A \mid B)$를 구하는 것이 관심이 대상이 됩니다.

앞의 진단검사 예제에서 문제를 '어떤 사람이 병 A에 걸렸을 확률을 계산하는 문제'로 조금 달리 접근해 봅시다.

1. 처음에는 어떤 사람이 병 A에 걸렸을 때 확률에 대해 아는 것이 없어, 전 세계 인구 절반이 해당 질병에 걸릴 확률인 1%의 유병률을 가정했다.
2. 그런데 정확도가 90%인 검사를 받았더닌 양성판정을 받았다.
3. **이 사람이 검사에서 양성판정을 받았다는 새로운 사실을 토대로** 이 사람이 실제로 병에 걸렸을 확률을 알 수 있지 않을까?

이 문제에서 베이즈 정리가 알려주는 것은, 만약 우리가 '<u>어떤 사건 A가 일어 났다고 가정할 때 B라는 자료를 얻게 될 확률' 에 대한 정보만 알고 있다면</u>, 자료에 근거해서 어떤 사건이 일어날 확류을 새로 계산 할 수 있다는 것입니다. 위의 사례에서는 검사의 정확도가 '<u>어떤 사건(병에 걸림)이 일어 낫다고 가정할 때 자료(양성 판정을 받음)을 얻게 될 확률</u>'에 대한 정보를 제공 해주기 때문에 이를 이용해 검사 결과를 토대로 그 사람이 병에 걸렸을 확률을 새로 계산 할 수 있습니다.

<br>

#### 베이즈 정리 용어

이러한 관점에서 베이즈 정리를 접근 할 때는 다음과 같은 추가 용어가 등장 합니다.

$$
\text{posterior} \propto \text{likelihood} \times \text{priror}
$$

위 식을 정리하면 다음과 같습니다.

|                  | **(사건 A의) 사후 확률**     | $\propto$ | **가능도**                   | $\times$ | **가능도**        |
| ---------------- | ---------------------------- | --------- | ---------------------------- | -------- | ----------------- |
| **수학적 표현**  | P(A\|B)                      | $\propto$ | P(B\|A)                      | $\times$ | P(A)              |
| **예(진단검사)** | P(병을 앓고 있다\|양성 판정) | $\propto$ | P(양성 판정\|병을 앓고 있다) | $\times$ | P(병을 앓고 있다) |

- **사전확률(Prior)** : 새로운 자료가 없는 상태에서 어떤 사건이 일어날 확률에 대한 가정이 필요한데 이를 사전 확률이라고 합니다.
- **가능도(Likelihood)**: 사건이 일어 났다는 가정하에 새로이 가지게 된 자료가 관측될 확률을 가능도라고 합니다.
- **사후 확률(posterior)** : 사전확률과 가능도를 이용해서 새롭계 게산한, '(새로운 자료를 미루어 보아 새롭게 판단한) 어떤 사건이 일어날 확률'을 사후 확률이하고 합니다.

베이즈 정리의 분모에 해당하는 부분은 가능도(Likelihood)를 구할 대 조건으로 걸린사건 (위의 예시의 경우, (실제 병의 유무와는 상관없이)양성 판정이 나오는 확률)의 확률을 의미합니다.


기능적으로 사후 확률이 확률의 정의(0이상 1이하)를 충족 시키도록 사전확룰과 가능도의 곱을 보정해주는 역할을 합니다. 위의 같은 예에서는 식이 간단하여 계산이 쉽지만, 복잡한 경우 등식을 비례 관계로 바꾸어 생략 할 수 있습니다.

<br>

## 정리

### 빈도주의 관점 vs. 베이지안 관점

예를 들어 동전의 앞면이 나올 확률이 50%다 라는 주장이 있다고 가정 해봅시다.

- 빈도주의: 100번 동전을 던져쓸 때 50번은 앞면이 나온다
- 베이지안 주의: 동저의 앞면이 나왔다는 **주장의 신뢰도가 50%이다**

### 용어 정리

위에서 설명한 내용을 기반으로 베이즈 정를 정리하면 다음과 같습니다.

$$
P(H \mid E)=\frac{P(E \mid H) P(H)}{P(E)}
$$

- **H**(Hypothesis) : 가설 혹은 '어떤 사건이 발생했다는 주장'
- **E**(Evidence): '새로운 정보'



- $P(H)$: 어떤 사건이 발생했다는 주장에 관한 **신뢰도**
- $P(H\mid E)$: 새로운 정보를 받은 후의 **갱신된 신뢰도**

이를 그림으로 정리하면 다음과 같습니다. 파란색 부분의 $P(H)$ 즉 사전확률(prior) 자체에 불확실성을 가지고 있기 때문에 이를 증거(Evidence) 즉, $P(E)$를 통해 어떻게 갱신 할 수 있는 지를 수식적으로 나타낸 것입니다.

![image-20210609133737665](https://i.loli.net/2021/06/09/oflTJVI7j8AeGMi.png)

<br>

### 베이즈 정리의 의의

베이즈 정리는 새로운 정보를 토대로 어떤 사건이 발생했다는 주장에 대한 신뢰도를 갱신해 나가는 방법(a method to update belief on the basis of new information)입니다.

기존의 통계학에서는 엄격하게 확률의 공간을 정의하거나 집단(모집단 혹은 표본집단)의 분포를 정의하고 그뒤에 계산을 통해 파생되는 결과물들을 수용하는 패러다임을 차용했습니다.

반면에, 베이지안 관점의 통계학에서는 사전확률과 같은 경험에 기반한 선험적인, 혹은 불확실성을 내포하는 수치를 기반으로 하고 거기에 추가적인 정보를 바탕으로 사전 확률을 갱신 합니다.

이러한 귀납적 추론 방식에서 베이지안 관점/통계학은 추가적인 근거를 확보를 통해 진리로 더 다가갈 수 있다는 철학을 내포하고 있는다는 점에서 빅데이터에서 사용되는 관점과 유사하다고 할 수 있습니다.

<br>

## 출처

- [베이즈 정리 - 위키백과, 우리 모두의 백과사전](https://ko.wikipedia.org/wiki/%EB%B2%A0%EC%9D%B4%EC%A6%88_%EC%A0%95%EB%A6%AC)
- [베이즈 정리의 의미 - 공돌이의 수학정리노트](https://angeloyeo.github.io/2020/01/09/Bayes_rule.html)
